{"ast":null,"code":"'use strict';\n\nvar utils = require('ethereumjs-util');\n\nvar BN = utils.BN;\n\nvar error = require('../exceptions.js').ERROR;\n\nvar fees = require('ethereum-common');\n\nvar assert = require('assert');\n\nmodule.exports = function (opts) {\n  assert(opts.data);\n  var results = {};\n  results.gasUsed = new BN(fees.ecrecoverGas.v);\n\n  if (opts.gasLimit.lt(results.gasUsed)) {\n    results.gasUsed = opts.gasLimit;\n    results.exception = 0; // 0 means VM fail (in this case because of OOG)\n\n    results.exceptionError = error.OUT_OF_GAS;\n    return results;\n  }\n\n  var data = utils.setLengthRight(opts.data, 128);\n  var msgHash = data.slice(0, 32);\n  var v = data.slice(32, 64);\n  var r = data.slice(64, 96);\n  var s = data.slice(96, 128);\n  var publicKey;\n\n  try {\n    publicKey = utils.ecrecover(msgHash, new BN(v).toNumber(), r, s);\n  } catch (e) {\n    return results;\n  }\n\n  results.return = utils.setLengthLeft(utils.publicToAddress(publicKey), 32);\n  results.exception = 1;\n  return results;\n};","map":null,"metadata":{},"sourceType":"script"}