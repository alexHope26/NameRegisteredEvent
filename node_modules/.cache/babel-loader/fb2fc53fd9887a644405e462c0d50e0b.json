{"ast":null,"code":"const ethUtil = require('ethereumjs-util');\n\nmodule.exports = secureInterface;\n\nfunction secureInterface(trie) {\n  // overwrites\n  trie.copy = copy.bind(trie, trie.copy.bind(trie));\n  trie.get = get.bind(trie, trie.get.bind(trie));\n  trie.put = put.bind(trie, trie.put.bind(trie));\n  trie.del = del.bind(trie, trie.del.bind(trie));\n} // adds the interface when copying the trie\n\n\nfunction copy(_super) {\n  var trie = _super();\n\n  secureInterface(trie);\n  return trie;\n}\n\nfunction get(_super, key, cb) {\n  var hash = ethUtil.sha3(key);\n\n  _super(hash, cb);\n} // for a falsey value, use the original key\n// to avoid double hashing the key\n\n\nfunction put(_super, key, val, cb) {\n  if (!val) {\n    this.del(key, cb);\n  } else {\n    var hash = ethUtil.sha3(key);\n\n    _super(hash, val, cb);\n  }\n}\n\nfunction del(_super, key, cb) {\n  var hash = ethUtil.sha3(key);\n\n  _super(hash, cb);\n}","map":null,"metadata":{},"sourceType":"script"}